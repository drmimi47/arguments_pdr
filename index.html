<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AR Image Sequence</title>
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.4/aframe/build/aframe-ar-nft.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
      #overlay {
        position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
        background: rgba(0,0,0,0.6); color: white; padding: 10px 20px; border-radius: 8px;
        font-family: sans-serif; text-align: center; max-width: 80%;
      }
    </style>
  </head>
  <body>
    <div id="overlay">Initializing AR experience...</div>

    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
      renderer="logarithmicDepthBuffer: true;"
    >
      <!-- Camera -->
      <a-entity camera position="0 1.6 0"></a-entity>

      <!-- Text Entity -->
      <a-entity id="text-sequence"
        position="0 1.5 -2"
        text="value: ; align: center; width: 3; wrapCount: 30; color: white">
      </a-entity>

      <!-- Image Panels (Initially Hidden) -->
      <a-image id="img1" src="argument_kiosk.jpg" position="-1 1.5 -3" rotation="0 0 0" visible="false"></a-image>
      <a-image id="img2" src="argument_mirror.jpg" position="0 1.5 -3" rotation="0 0 0" visible="false"></a-image>
      <a-image id="img3" src="argument_turnstile.jpg" position="1 1.5 -3" rotation="0 0 0" visible="false"></a-image>
    </a-scene>

    <script>
      const overlay = document.getElementById('overlay');
      const textEntity = document.getElementById('text-sequence');

      // Text sequence messages
      const messages = [
        "Welcome to the experience.",
        "Follow the story step by step.",
        "Now, explore the images."
      ];

      // Function to update text in sequence
      function runTextSequence() {
        let index = 0;
        const interval = setInterval(() => {
          if (index < messages.length) {
            textEntity.setAttribute('text', 'value', messages[index]);
            index++;
          } else {
            clearInterval(interval);
            showImages();
          }
        }, 3000);
      }

      // Show images after text sequence
      function showImages() {
        overlay.textContent = "Tap an image to rotate it.";
        document.getElementById('img1').setAttribute('visible', 'true');
        document.getElementById('img2').setAttribute('visible', 'true');
        document.getElementById('img3').setAttribute('visible', 'true');
      }

      // Tap to rotate
      function makeInteractive(el) {
        el.addEventListener('click', () => {
          const currentRot = el.getAttribute('rotation');
          el.setAttribute('rotation', {
            x: currentRot.x,
            y: currentRot.y + 45,
            z: currentRot.z
          });
        });
      }

      ['img1', 'img2', 'img3'].forEach(id => makeInteractive(document.getElementById(id)));

      // Start AR sequence when ready
      window.addEventListener('load', () => {
        overlay.textContent = "AR ready. Starting sequence...";
        setTimeout(runTextSequence, 1000);
      });
    </script>
  </body>
</html>
